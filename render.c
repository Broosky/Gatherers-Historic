/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Program Name: Gatherers (C)                                                                                            //
//  Author: Jeffrey Bednar                                                                                                 //
//  Copyright: Illusion Interactive, 2011                                                                                  //
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#ifndef _RENDER_C_
#define _RENDER_C_
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "main.h"
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl RENDER_Init(DBLBUF* p_DblBuf) {
    SetGraphicsMode((*p_DblBuf).hDCMem, GM_ADVANCED);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl RENDER_ApplyTransform(DBLBUF* p_DblBuf, int iType, float fValue, FPOINT Pin) {
    switch(iType) {
        case RENDER_ROTATE: {
            float fRadians = MISC_CalculateRadians(fValue);
            float fSin = sin(fRadians);
            float fCos = cos(fRadians);
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            // Possible lookup table?
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            (*p_DblBuf).XForm.eM11 = fCos;
            (*p_DblBuf).XForm.eM12 = fSin;
            (*p_DblBuf).XForm.eM21 = -fSin;
            (*p_DblBuf).XForm.eM22 = fCos;
            (*p_DblBuf).XForm.eDx = Pin.fX;
            (*p_DblBuf).XForm.eDy = Pin.fY;
            /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            break;
        }
        case RENDER_SCALE: {
            (*p_DblBuf).XForm.eM11 = fValue;
            (*p_DblBuf).XForm.eM12 = 0.0f;
            (*p_DblBuf).XForm.eM21 = 0.0f;
            (*p_DblBuf).XForm.eM22 = fValue;
            (*p_DblBuf).XForm.eDx = Pin.fX;
            (*p_DblBuf).XForm.eDy = Pin.fY;
        }
    }
    SetWorldTransform((*p_DblBuf).hDCMem, &(*p_DblBuf).XForm);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void __cdecl RENDER_ResetTransform(DBLBUF* p_DblBuf) {
    (*p_DblBuf).XForm.eDx = 0.0f;
    (*p_DblBuf).XForm.eDy = 0.0f;
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    ModifyWorldTransform((*p_DblBuf).hDCMem, NULL, MWT_IDENTITY);
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#endif
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
